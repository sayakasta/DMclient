<projectcomponents xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" project="ProducerOne" xsi:noNamespaceSchemaLocation="../../schemas/components_XSD.xsd">
  <component metaobject="noteuid_list;task_lku;agency_tasks;agency_callreport;call_objective_lku;" name="prospectCallReportDetails" stackdisplayname="Relationship MGMT Call Reports">
 <action deltaind="M" name="download">
      <workflow  deltaind="M" name="download" seq="0">
        <databaseoperation deltaind="M" executionsequence="1" metaobject="agency_callreport" name="getagencycallreport" operation="3" sqlstmt="select (select cast(STUFF((SELECT distinct  ','+call_objective_desc FROM call_objective_lku where  call_objective_id  in(select items from dbo.Split(acr.call_objective_ids,','))        FOR XML PATH('')) , 1, 1, '') as varchar(8000)) )  as call_objective,acr.purpose_of_call_desc as purpose_of_call_other_desc,acr.*,case when acr.zone_code is null  or acr.zone_code ='' then 'NULL' else (select zone_desc from zones_lku zlk where zlk.zone_code = acr.zone_code)  end as zone_desc,case when acr.call_status=1 then 'Not Started' else case when acr.call_status=2 then 'In Progress'  else case when acr.call_status=3 then 'Complete' end end end as call_status_desc,mrl.market_rep_desc, (select business_segment_name from business_segment where business_segment_code=acr.business_segment_code)  as business_segment_name, (CASE WHEN call_type = 1 THEN 'Physical Visit'  ELSE CASE WHEN call_type=2 THEN 'Phone Call'  ELSE CASE WHEN call_type=3 THEN 'Email' END END END) as call_type_desc, (CASE WHEN call_status =1 THEN 'Not Started'  ELSE CASE WHEN call_status =2 THEN 'In Progress' ELSE CASE WHEN call_status =3 THEN 'Complete' END END END) as call_status_desc,  (select prospect_agency_name from relationship.prospect_agency_detail where prospect_agency_id=acr.location) as location_desc, (select prospect_agency_name from relationship.prospect_agency_detail where prospect_agency_id=acr.prospect_agency_id)  as name_desc,od.Operating_division_description, pcl.purpose_of_call_desc as purpose_of_call_description,mrl.market_rep_desc, (Select f31 from configurationclient.html_extendedfields_mapping_data where object_id=acr.prospect_callreport_id)as addProspectAgencyCallReportDetails_followup_date from  relationship.prospect_callreport acr  LEFT JOIN operating_division od WITH(NOLOCK) ON od.Operating_division_id = acr.Operating_division_id  LEFT JOIN purpose_of_call_lku pcl WITH(NOLOCK) ON pcl.purpose_of_call_id = acr.call_purpose  LEFT JOIN market_rep_lku mrl WITH(NOLOCK) ON acr.market_rep_id = mrl.market_rep_id where prospect_callreport_id=#prospect_callreport_id#"/>
         </workflow>
    </action>
    
  </component>
</projectcomponents>
